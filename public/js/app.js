
document.addEventListener('DOMContentLoaded',()=>{const y=document.getElementById('year');if(y)y.textContent=new Date().getFullYear();});
(function(){const p=[...document.querySelectorAll('.nav a')].find(a=>a.textContent.trim().toLowerCase()==='product');if(!p)return;p.addEventListener('click',e=>{e.preventDefault();document.body.classList.toggle('show-subnav');scrollTo({top:0,behavior:'smooth'});});})();
(function(){const hero=document.querySelector('.hero-halo');if(!hero)return;const ring=hero.querySelector('.halo-bg .ring');function onS(){const r=hero.getBoundingClientRect();const vh=innerHeight;const t=Math.min(1,Math.max(0,(vh-r.top)/vh));ring.style.transform=`scale(${0.75+0.6*t})`;ring.style.opacity=String(0.35+0.6*t);if(t>0.1)hero.classList.add('scrolled');else hero.classList.remove('scrolled');}onS();addEventListener('scroll',onS,{passive:true});const cards=[...document.querySelectorAll('.card')];const io=new IntersectionObserver(es=>es.forEach(e=>{if(e.isIntersecting)e.target.classList.add('show')}),{threshold:.2});cards.forEach(c=>io.observe(c));})();
(function(){const scene=document.querySelector('.scene');if(!scene)return;const items=[...scene.querySelectorAll('.h-item')];const hero=scene.querySelector('img.hero');const back=scene.querySelector('img.back');const io=new IntersectionObserver(es=>{es.forEach(e=>{if(e.isIntersecting)e.target.classList.add('show');});},{threshold:.4});items.forEach(i=>io.observe(i));function fade(){const rect=scene.getBoundingClientRect();const vh=innerHeight;const p=(vh-rect.top)/(rect.height);const front=Math.max(0,1-(p*2-0.2));const b=Math.max(0,(p*2-0.2));if(hero){hero.style.opacity=Math.min(1,Math.max(0,front));if(front>0.02)hero.classList.add('visible');}if(back){back.style.opacity=Math.min(1,Math.max(0,b));if(b>0.02)back.classList.add('visible');}}addEventListener('scroll',fade,{passive:true});fade();})();
